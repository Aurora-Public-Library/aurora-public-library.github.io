(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{2003:function(e,t,a){"use strict";var r=a(0);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.default}});var n=r(a(2004))},2004:function(e,t,a){"use strict";var r=a(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(20)),s=r(a(23)),i=r(a(24)),o=r(a(38)),c=r(a(25)),l=r(a(26)),d=r(a(27)),u=r(a(5)),f=r(a(1)),p=r(a(6)),m=a(15),g=a(288),h=a(42),b=r(a(655)),E=a(152);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}a(2005);var v=function(e){(0,c.default)(a,e);var t=y(a);function a(e){var r;return(0,s.default)(this,a),(r=t.call(this,e)).state={height:"0"},(0,h.bindAll)((0,o.default)(r)),r}return(0,i.default)(a,[{key:"componentDidMount",value:function(){this.props.fitToText&&this.updateHeightToFitText()}},{key:"getTextAreaStyle",value:function(){var e={};return this.props.minHeight&&(e.minHeight=this.props.minHeight),this.state.height&&this.props.fitToText&&(e.height=this.state.height+"px",e.overflow="hidden"),e}},{key:"handleChange",value:function(){var e=this._textarea.value;this.props.fitToText&&this.updateHeightToFitText(),this.props.handleChange&&this.props.handleChange(e)}},{key:"updateHeightToFitText",value:function(){var e=this;this.setState({height:"inherit"},(function(){var t;e.setState({height:""+(null===(t=e._textarea)||void 0===t?void 0:t.scrollHeight)})}))}},{key:"renderCharacterCount",value:function(){var e=this.props,t=e.value,a=e.suggestedMaxLength,r=e.maxLength;return a||r?f.default.createElement(b.default,{count:t?t.length:0,limit:a||r}):null}},{key:"render",value:function(){var e=this;return f.default.createElement("div",{className:(0,p.default)("cp-text-area",this.props.className,{"text-area--invalid":this.props.errorMessage}),"data-key":this.props.dataKey},f.default.createElement("label",{htmlFor:this.props.id},this.props.label,this.props.optional&&f.default.createElement("span",{className:"text-area__label__optional"},"(",f.default.createElement(m.FormattedMessage,{id:"optional"}),")")),f.default.createElement("textarea",(0,n.default)({},(0,E.getValidHtmlAttributes)(this.props,"textarea"),{className:"text-area__textarea",id:this.props.id,ref:function(t){e._textarea=t},onChange:this.handleChange,"data-key":"text-area",style:this.getTextAreaStyle()})),this.props.errorMessage&&f.default.createElement(g.ErrorAlert,null,this.props.errorMessage),this.renderCharacterCount())}}]),a}(f.default.PureComponent);t.default=v,v.propTypes={fitToText:u.default.bool,maxLength:u.default.number,suggestedMaxLength:u.default.number,id:u.default.string.isRequired,label:u.default.oneOfType([u.default.arrayOf(u.default.node),u.default.node,u.default.string]),errorMessage:u.default.oneOfType([u.default.arrayOf(u.default.node),u.default.node,u.default.string]),value:u.default.string,handleChange:u.default.func,optional:u.default.bool,dataKey:u.default.string,className:u.default.string,minHeight:u.default.string},v.defaultProps={fitToText:!1}},2005:function(e,t,a){"use strict";a.r(t)},675:function(e,t,a){"use strict";a.r(t);var r,n,s=a(1),i=a.n(s),o=a(32),c=a(57),l=a(132),d=a(56),u=a.n(d);var f={submitFeedback:function(e,t){var a=t.route(r||(r=u()(["/libraries/","/feedback"])),":librarySubdomain");return t.post(a,e)},submitGroupSearchFeedback:function(e,t){var a=t.route(n||(n=u()(["/libraries/","/feedback/groupsearch"])),":librarySubdomain");return t.post(a,e)}},p=a(70);var m={collapseFeedbackBox:function(){return{type:l.a.COLLAPSE_FEEDBACK}},expandFeedbackBox:function(){return{type:l.a.EXPAND_FEEDBACK}},updateCategory:function(e){return{type:l.a.UPDATE_CATEGORY,payload:e}},submitFeedback:function(e){return{types:[l.a.SUBMIT_FEEDBACK_REQUEST,l.a.SUBMIT_FEEDBACK_SUCCESS,l.a.SUBMIT_FEEDBACK_FAILURE],apiRequest:function(t,a){return f.submitFeedback(e,a)},apiSuccess:function(){return{messaging:Object(p.a)("message_feedback_confirmed")}}}}},g=a(81),h=a(100),b=a(29),E=a.n(b),y=a(15),v=a(660),k=a(290),C=a.n(k),x=a(97),_=a(76),F=a(51),O=a.n(F);function S(e){var t=e.contactLinks;return t.isEmpty()?null:i.a.createElement("div",{className:"cp-feedback-contact-links"},i.a.createElement(C.a,{tagName:"h3",size:"medium"},i.a.createElement(y.FormattedMessage,{id:"feedback_contact_lib_heading"})),t.entrySeq().map((function(e){var t=e[0],a=e[1];return i.a.createElement("p",{key:t},i.a.createElement("a",{href:a},i.a.createElement(y.FormattedMessage,{id:t})))})))}S.displayName="FeedbackContactLinks";var M=a(9),w=a.n(M),T=a(38),N=a.n(T),P=a(2),j=a.n(P),B=a(42),L=a(654),A=a(2003),I=a.n(A);function D(e){var t=e.value,a=e.handleMessageChange,r=e.selectedCategory,n=i.a.createElement(O.a,null,i.a.createElement(y.FormattedMessage,{id:"feedback_comment_label"}));return i.a.createElement("div",null,i.a.createElement("div",{className:"form-group"},i.a.createElement(I.a,{maxLength:4e3,required:!0,value:t,id:"feedback-message",label:n,handleChange:a,rows:"5",cols:"60"})),i.a.createElement("div",{className:"text-right form-group"},i.a.createElement(x.PrimarySolidButton,{dataKey:"feedback-submit-button",type:"submit",disabled:null===r},i.a.createElement(y.FormattedMessage,{id:"feedback_submit_feedback_btn"}))))}function H(){var e=Object(o.useSelector)(h.b);return i.a.createElement("a",{href:"//"+e.get("domain")+".bibliocommons.com/suggested_purchases"},i.a.createElement(y.FormattedMessage,{id:"feedback_suggest_for_purchase_link"}))}function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(Object(a),!0).forEach((function(t){w()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}D.displayName="CommentableForm";var U=function(e){function t(t){var a;return a=e.call(this,t)||this,Object(B.bindAll)(N()(a)),a.state={messageText:""},a}E()(t,e),t.getBrowserInformation=function(){return{screenResolution:window.screen.width+" x "+window.screen.height,viewportSize:window.outerWidth+" x "+window.outerHeight,referer:window.location.href,userAgent:window.navigator.userAgent}};var a=t.prototype;return a.getCategoryOptions=function(){var e=this;return this.props.categories.valueSeq().map((function(t){return j.a.Map({label:e.props.intl.formatMessage({id:"feedback_cat_"+t}),value:t})})).toList()},a.getSelectedCategoryLabel=function(){var e=this.props.selectedCategory||"default";return this.props.intl.formatMessage({id:"feedback_cat_"+e})},a.handleSubmit=function(e){e.preventDefault(),this.props.actions.submitFeedback(R(R({comment:this.state.messageText},t.getBrowserInformation()),{},{category:this.props.selectedCategory,optIn:!1}))},a.handleMessageChange=function(e){this.setState({messageText:e})},a.renderFormFields=function(){switch(this.props.selectedCategory){case null:return null;case"suggest_for_purchase":return this.props.suggestForPurchaseEnabled?i.a.createElement(H,null):i.a.createElement(D,{value:this.state.messageText,selectedCategory:this.props.selectedCategory,handleMessageChange:this.handleMessageChange});default:return i.a.createElement(D,{value:this.state.messageText,handleMessageChange:this.handleMessageChange})}},a.render=function(){return i.a.createElement("form",{className:"cp-feedback-form",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"form-group"},i.a.createElement(O.a,{id:"feedback-category-label"},i.a.createElement(y.FormattedMessage,{id:"feedback_category_label"})),i.a.createElement(L.Dropdown,{dropup:!0,dataKey:"feedback-form-dropdown",handleSelect:this.props.actions.updateCategory,labelledById:"feedback-category-label",options:this.getCategoryOptions(),renderLabel:this.getSelectedCategoryLabel})),this.renderFormFields())},t}(i.a.PureComponent),q=Object(y.injectIntl)(U),z=function(e){function t(){return e.apply(this,arguments)||this}E()(t,e);var a=t.prototype;return a.renderCloseButton=function(e){return i.a.createElement(x.IconButton,{dataKey:"feedback-close-button",className:"feedback-close-button "+(e?"visible-xs":"hidden-xs"),"aria-label":this.props.intl.formatMessage({id:"button_close"}),handleClick:this.props.actions.collapseFeedbackBox},i.a.createElement(_.Close,null),i.a.createElement(O.a,null,i.a.createElement(y.FormattedMessage,{id:"button_close"})))},a.renderCollapsed=function(){return i.a.createElement("div",{className:"feedback-teaser container clearfix"},i.a.createElement("div",{className:"feedback-left-content"},i.a.createElement(C.a,{tagName:"h3",size:"medium",className:"category-name"},i.a.createElement(y.FormattedMessage,{id:"feedback_heading"})),i.a.createElement(y.FormattedMessage,{tagName:"p",id:"feedback_prompt"})),i.a.createElement("div",{className:"feedback-right-content "},i.a.createElement(x.PrimarySolidButton,{className:"feedback-expand-btn",dataKey:"submit-feedback-button",handleClick:this.props.actions.expandFeedbackBox},i.a.createElement(y.FormattedMessage,{id:"feedback_submit_feedback_btn"}))))},a.renderExpanded=function(){return i.a.createElement("div",{className:"feedback-expanded container clearfix"},i.a.createElement("div",{className:"feedback-left-content"},this.renderCloseButton(!0),i.a.createElement(C.a,{tagName:"h3",size:"medium"},i.a.createElement(y.FormattedMessage,{id:"feedback_heading"})),i.a.createElement(v.FormattedHTMLMessage,{tagName:"p",id:"feedback_review_notice"}),i.a.createElement(q,{categories:this.props.categories,selectedCategory:this.props.selectedCategory,isSubmitting:this.props.isSubmitting,actions:this.props.actions,suggestForPurchaseEnabled:this.props.suggestForPurchaseEnabled})),i.a.createElement("div",{className:"feedback-right-content"},this.renderCloseButton(!1),i.a.createElement("div",{className:"contact-links"},i.a.createElement(S,{contactLinks:this.props.contactLinks}))))},a.render=function(){return i.a.createElement("div",{className:"cp-feedback-box"},i.a.createElement("div",{className:"feedback-wrapper"},this.props.expanded?this.renderExpanded():this.renderCollapsed()))},t}(i.a.PureComponent),G=Object(y.injectIntl)(z);t.default=Object(o.connect)((function(e){var t=Object(g.c)(e),a=Object(h.b)(e);return{user:t,enabled:a.getIn(["feedback","enabled"]),categories:a.getIn(["feedback","categories"]),contactLinks:a.getIn(["feedback","links"]),expanded:e.getIn(["ui","feedback","expanded"]),selectedCategory:e.getIn(["ui","feedback","category"]),isSubmitting:e.getIn(["ui","feedback","isSubmitting"]),suggestForPurchaseEnabled:a.getIn(["suggestForPurchase","premium","enabled"])}}),(function(e){return{actions:Object(c.bindActionCreators)(m,e)}}))((function(e){var t=e.user,a=e.enabled,r=e.actions,n=e.categories,s=e.contactLinks,o=e.expanded,c=e.selectedCategory,l=e.isSubmitting,d=e.suggestForPurchaseEnabled;return t&&a?i.a.createElement(G,{actions:r,categories:n,contactLinks:s,expanded:o,selectedCategory:c,isSubmitting:l,suggestForPurchaseEnabled:d}):null}))}}]);
//# sourceMappingURL=app.app-components-layouts-FeedbackBox-FeedbackBoxContainer-ee988b036fd1db5c23e5.js.map